---
title: IP地址与子网掩码
tags: IP/子网掩码
notebook: 计算机网络
---

[TOC]

# IP地址与子网掩码

## IP地址

电脑之间要实现网络通信，就必须要有一个合法的ip地址。`IP地址=网络地址+主机地址`，（又称：主机号和网络号组成）ip地址的结构使我们可以在Internet上很方便的寻址。ip地址通常用更直观的，以圆点分隔号的四个十进制数字表示，每个数字从0到255，如某一台主机的ip地址为：128.20.4.1在局域网里，同样也需要ip地址，一般内网的ip地址是以192.168开头的，这样很容易区分公网和内网的ip地址。

假设IP地址是192.168.100.1,这个地址中包含了很多含义.如下所示:

``` text
网络地址(相当于街道地址): 192.168.100.0
主机地址(相当于各户的门号): 0.0.0.1
IP地址(相当于住户地址): 网络地址+主机地址=192.168.100.1
广播地址: 192.168.100.255
```

**注意上述的参数并不是直接看出来的，是通过子网掩码解析出来的！！**

### 计算网络地址

1. 将 IP 地址与子网掩码转换成二进制；
1. 将二进制形式的 IP 地址与子网掩码做 ' 与 ' 运算，将答案化为十进制便得到网络地址；
1. 将二进制形式的子网掩码取 ' 反 ' ；
1. 将取 ' 反 ' 后的子网掩码与 IP 地址做 ' 与 ' 运算，将答案化为十进制便得到主机地址。

_由于很多子网掩码的地址都是255.255.255.0，按照上述方式计算都是ip的前24位和最后8位_

## 默认网关

那么网关到底是什么呢？网关实质上是一个网络通向其他网络的IP地址。比如有网络A和网络B，网络A的IP地址范围为“192.168.1.1~192. 168.1.254”，子网掩码为255.255.255.0；网络B的IP地址范围为“192.168.2.1~192.168.2.254”，子网掩码为255.255.255.0。在没有路由器的情况下，两个网络之间是不能进行TCP/IP通信的，即使是两个网络连接在同一台交换机（或集线器）上，TCP/IP协议也会根据子网掩码（255.255.255.0）判定两个网络中的主机处在不同的网络里。而要实现这两个网络之间的通信，则必须通过网关。如果网络A中的主机发现数据包的目的主机不在本地网络中，就把数据包转发给它自己的网关，再由网关转发给网络B的网关，网络B的网关再转发给网络B的某个主机（如附图所示）。网络A向网络B转发数据包的过程。
所以说，只有设置好网关的IP地址，TCP/IP协议才能实现不同网络之间的相互通信。那么这个IP地址是哪台机器的IP地址呢？网关的IP地址是具有路由功能的设备的IP地址，具有路由功能的设备有路由器、启用了路由协议的服务器（实质上相当于一台路由器）、代理服务器（也相当于一台路由器）。

## 子网掩码

即未划分子网，对应的网络号的位都置 1 ，主机号都置 0 。

A 类网络缺省子网掩码： 255.0.0.0

B 类网络缺省子网掩码： 255.255.0.0

C 类网络缺省子网掩码： 255.255.255.0

### 划分子网

第一步：确定物理网段的数量，并将其转换为二进制数，并确定位数 n 。如：你需要 6 个子网， 6 的二进制值为 110 ，共 3 位 , 即 n=3 ；

第二步：按照你 IP 地址的类型写出其缺省子网掩码。如 C 类，则缺省子网掩码为 11111111.11111111.11111111.00000000 ；

第三步：将子网掩码中与主机号的前 n 位对应的位置置 1 ，其余位置置 0 。若 n=3 且为

C 类地址：则得到子网掩码为 11111111.11111111.11111111.11100000 化为十进制得到 255.255.255.224

B 类地址：则得到子网掩码为 11111111.11111111.11100000.00000000 化为十进制得到 255.255.224.0

A 类地址：则得到子网掩码为 11111111.11100000.00000000.00000000 化为十进制得到 255.224.0.0

另：由于网络被划分为 6 个子网，占用了主机号的前 3 位，若是 C 类地址，则主机号只能用 5 位来表示主机号，因此每个子网内的主机数量＝（ 2^5 ）－ 2 ＝ 30 ， 6 个子网总共所能标识的主机数将小于 254 ，这点请大家注意！（至于为什么减 2 ，可看后面说明）

**通过子网掩码计算子网数量**

1. 观察子网掩码的二进制形式，确定作为子网号的位数 n ；

2. 子网数量为 2^n － 2 。（为什么减 2 ，继续往下看）

举个例子来说，比如有这样一个子网掩码： 255.255.255.224 其二进制为：

11111111.11111111.11111111.11100000

可见 n=3,2 的 3 次方为 8 ，说明子网地址可能有

如下 8 种情况：

000      001      010       011      100     101      110      111

但其中代表网络自身的 000 ；代表广播地址的 111 是被保留的，所以要减 2 。

**计算总主机数量**

总主机数量＝子网数量×子网内主机数量

再用一个例子给大家说明，比如子网掩码为 255.255.255.224

上面的讨论知道它最多可以划分 6 个子网，那么每个子网内最多有多少个主机呢？其实上面我已经给大家算过了，由于网络被划分为 6 个子网，占用了主机号的前 3 位，且是 C 类地址，则主机号只能用 5 位来表示主机号，因此子网内的主机数量＝（ 2 的 5 次方）－ 2 ＝ 30.

因此通过这个子网掩码我们可以算出这个网络最多可以标识 6*30=180 个主机（可见，在化分子网后，整个网络所能标识的主机数量将减少）。

